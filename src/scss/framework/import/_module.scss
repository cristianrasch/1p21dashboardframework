/*** MODULES ***/

$calculated-module-title-font-size: $module-title-font-size;
@if internal-is-convertable($module-title-font-size) {
	$calculated-module-title-font-size: rem($module-title-font-size / $body-font-size);
}

$calculated-module-grid-title-font-size: $module-grid-title-font-size;
@if internal-is-convertable($module-grid-title-font-size) {
	$calculated-module-grid-title-font-size: rem($module-grid-title-font-size / $body-font-size);
}

$prefix: '.module';
#{$prefix} {
	&-grid {
		// grid-template-columns: 100%;
		// grid-template-rows: auto;
		display: grid;
		grid-gap: $module-gutter-grid-gap;
		transition:$transition-duration-long opacity $transition-timing;
		max-width:100%;

		&:nth-child(n+2) {
			margin-top:$module-grid-gutter;
		}
		
		@include br($mobile-br-max-opposite){

			.body-loading & {
				opacity: 0;
			}

			.body-loaded & {
				opacity: 1;
			}
		}
	}


	&-grid-title {
		@include type-set((

			size:$calculated-module-grid-title-font-size,
			// leading: strip-unit($module-grid-title-line-height/$module-grid-title-font-size),
			color: $module-grid-title-color,
			case: $module-grid-title-text-transform,
			weight: $module-grid-title-font-weight,
			style: $module-grid-title-font-style
		));
		display:flex;
		align-items: center;


		&:nth-last-child(n+2){
			margin-bottom: $module-grid-title-margin-bottom;
		}
		
		&:nth-child(n+2){
			margin-top: $module-grid-title-margin-top;
		}

		@include decoration-bar((
			pseudo:after,
			height: $module-grid-title-rule-height,
			color: $module-grid-title-rule-color
		)){
			flex: 1 1;
			margin-left: 1em;
		};

	}

	&,&-grid {
		max-width:100%;
	}

	& {
		background: $module-bg-color;
		overflow:hidden;
		display: grid;
		grid-template-columns: 100%;
		grid-template-rows: auto 1fr auto;
		grid-template-areas: 
		"header"
		"content"
		"footer";
		transition: $transition-duration-long box-shadow $transition-timing;

		.body-inverse & {

			background: $module-bg-color-inverse;
		}

		&:not(#{prefix}-no-interaction):hover,
		&:not(#{prefix}-no-interaction):focus,
		&:not(#{prefix}-no-interaction).focus {
			box-shadow: $module-box-shadow-hover;
		}
		
	}

	&,
	&-header:first-child,
	&-content:first-child,
	&-footer:first-child {
		padding-top: $module-gutter-y;
		border-top-left-radius: $module-border-radius;
		border-top-right-radius: $module-border-radius;
	}

	&-header:first-child,
	&-content:first-child,
	&-footer:first-child {
		margin-top: $module-gutter-y * -1;
	}

	&,
	&-header:last-child,
	&-content:last-child,
	&-footer:last-child {
		padding-bottom: $module-gutter-y;
		border-bottom-left-radius: $module-border-radius;
		border-bottom-right-radius: $module-border-radius;
	}

	
	&-header:last-child,
	&-content:last-child,
	&-footer:last-child {
		margin-bottom: $module-gutter-y * -1;
	}

	&,
	&-header,
	&-content,
	&-footer {
		padding-left: $module-gutter-x;
		padding-right: $module-gutter-x;
		// overflow:hidden;
	}

	&-header,
	&-content,
	&-footer {
		margin-left: $module-gutter-x * -1;
		margin-right: $module-gutter-x * -1;
	}

	&-header {
		grid-area: header;
	
		&:not(:last-child) {
			margin-bottom: $module-gutter-between;
		}


		&-break {

			@include br($mobile-br-max-opposite){

				display:flex;
				flex-wrap: wrap;
				justify-content: space-between;
				align-items: center;

				#{$prefix}-title:not(:first-child:last-child),
				#{$prefix}-function:not(:first-child:last-child) {
					width: 50%;
				}

				#{$prefix}-functions {
					padding-left: 1rem;
					margin-top: 0;
					flex: 1 1;
					text-align: right;

					.btn-group,.input-group {
						margin-top: 0;
						display:inline-flex;
					}
				}
			}
		}
	}

		&-title {
			@include type-set((

				size:$calculated-module-title-font-size,
				// leading: strip-unit($module-title-line-height/$module-title-font-size),
				color: $module-title-color,
				case: $module-title-text-transform,
				weight: $module-title-font-weight,
				style: $module-title-font-style
			));
			margin-bottom:0;
		}

		&-functions {
			margin-top: $module-gutter-between;


			> .btn,
			> .btn-group,
			> .input-group,
			> .input-wrapper {
				margin-top: $module-gutter-between * .5;
			}

			@include br(#{$mobile-br-max-opposite}) {
				#{$prefix}-header-break & {
					> .btn,
					> .btn-group,
					> .input-group,
					> .input-wrapper {

						margin-top:0;
					}
				}

				> .btn,
				> .btn-group,
				> .input-group,
				> .input-wrapper {

					&:nth-child(n+2) {
						margin-left: .75rem;
					}
				}
			}

			@include br(#{$mobile-br-max-opposite}) {
				
			}

			.btn-group,.input-group {
				flex-direction: row;
			}

			.input-wrapper {
				margin-right: 0;
			}
		}
	

	&-content {
		grid-area: content;
		overflow-y:auto;
		overflow-x:hidden;

		&::-webkit-scrollbar {
			display:none;
		}
	}
	

	&-footer {
		grid-area: footer;

		&:not(:first-child){
			margin-top: $module-gutter-between;
		}
	}
	

	@include br(#{$mobile-br-max}-max) {
		&,
		&-header:first-child,
		&-content:first-child,
		&-footer:first-child {
			padding-top: $module-gutter-y-mobile;
		}

		&-header:first-child,
		&-content:first-child,
		&-footer:first-child {
			margin-top: $module-gutter-y-mobile * -1;
		}

		&,
		&-header:last-child,
		&-content:last-child,
		&-footer:last-child {
			padding-bottom: $module-gutter-y-mobile;
		}

		
		&-header:last-child,
		&-content:last-child,
		&-footer:last-child {
			margin-bottom: $module-gutter-y-mobile * -1;
		}

		&,
		&-header,
		&-content,
		&-footer {
			padding-left: $module-gutter-x-mobile;
			padding-right: $module-gutter-x-mobile;
			// overflow:hidden;
		}

		&-header,
		&-content,
		&-footer {
			margin-left: $module-gutter-x-mobile * -1;
			margin-right: $module-gutter-x-mobile * -1;
		}
	}

	&-no-gutter {
		padding:0!important;
		
		#{$prefix}-header,
		#{$prefix}-content,
		#{$prefix}-footer {
			padding-top: 0!important;
			padding-bottom:0!important;
			margin:0!important;

		}
	}

}